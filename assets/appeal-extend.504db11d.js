import{a as g}from"./_@vue_runtime-dom@3.2.31@@vue.240af360.js";import{U as d}from"./index.67bdbe62.js";import{_ as D}from"./plugin-vue_export-helper.21dcd24c.js";import{r as m}from"./_@vue_reactivity@3.2.31@@vue.435b5d06.js";import{y as r,z as C,A as L,m as p,G as h,E as o,r as j,K as x,L as I,s as z}from"./_@vue_runtime-core@3.2.31@@vue.b0aa5f29.js";import"./_@vue_shared@3.2.31@@vue.7f2d3904.js";import"./_vant@3.4.6@vant.e4fff504.js";import"./_@vant_use@1.3.6@@vant.1b0ef691.js";import"./_@vant_popperjs@1.1.0@@vant.ae31ad00.js";import"./_vue-mobile-calendar@3.3.0@vue-mobile-calendar.c9c3461a.js";import"./_axios@0.21.4@axios.56d8ec29.js";import"./_vuex@4.0.2@vuex.35900dea.js";import"./_@vue_devtools-api@6.1.3@@vue.3188b863.js";import"./_vue-router@4.0.14@vue-router.c27d2a8d.js";import"./_qs@6.10.3@qs.59603e06.js";import"./_side-channel@1.0.4@side-channel.0a841574.js";import"./_get-intrinsic@1.1.1@get-intrinsic.46bb42c1.js";import"./_has-symbols@1.0.3@has-symbols.7f361f9b.js";import"./_function-bind@1.1.1@function-bind.09a6b7a3.js";import"./_has@1.0.3@has.dc0c57e0.js";import"./_call-bind@1.0.2@call-bind.c10bfa07.js";import"./_object-inspect@1.12.0@object-inspect.b4aaeeae.js";import"./_lodash@4.17.21@lodash.2e4506b9.js";import"./_dayjs@1.11.0@dayjs.c3a0a36c.js";import"./_echarts@5.2.2@echarts.518f2fa5.js";import"./_tslib@2.3.0@tslib.54efd67f.js";import"./_zrender@5.2.1@zrender.d1d234d3.js";const y={setup(){const t=m(!0),e=m([]),a=m([]);return{activeNames:e,receivePic:n=>{a.value=n,t.value=!0,console.log(t.value)},picImgs:a,uploadDone:n=>{t.value=n,console.log(t.value)},hasUploadDone:t}},data(){return{navStyle:{navTitle:"\u4F01\u4E1A\u8BC9\u6C42\u8FFD\u52A0",color:"#fff",backgroundColor:"#236EED",leftIcon:"arrowthinleft"},columnNum:"3",apealStatue:2,radioItems:[{value:"0",name:"\u975E\u5E38\u6EE1\u610F",checked:"true"},{value:"1",name:"\u6EE1\u610F"},{value:"2",name:"\u57FA\u672C\u6EE1\u610F"},{value:"3",name:"\u4E0D\u6EE1\u610F"},{value:"4",name:"\u975E\u5E38\u4E0D\u6EE1\u610F"}],current:"0",collCurrent:-1,imgList:[],control:!0,id:"",statueData:{},selectData:[{id:0,name:"\u571F\u5730\u6D77\u6D0B\u89C4\u5212",isChoose:!1},{id:1,name:"\u80FD\u6E90\u73AF\u4FDD",isChoose:!1},{id:2,name:"\u4EBA\u529B\u793E\u4FDD",isChoose:!1},{id:3,name:"\u5E02\u573A\u76D1\u7BA1\u5BA1\u6279",isChoose:!1},{id:4,name:"\u8D22\u52A1\u7A0E\u6536",isChoose:!1},{id:5,name:"\u5B89\u5168\u751F\u4EA7",isChoose:!1},{id:6,name:"\u6559\u80B2\u536B\u751F",isChoose:!1},{id:7,name:"\u9053\u8DEF\u4EA4\u901A",isChoose:!1},{id:8,name:"\u653F\u7B56\u5151\u73B0",isChoose:!1}],zuijia:{aplId:"",aplBatNum:"",aplContent:"",attachmentList:[],srcCode:1,srcName:"APP"},zuijiaData:[],mainData:{backHistorys:[[{result:""}]],attachments:[]},imgListSo:[],imgListIds:[],isWebdiv:0}},created(){let t=this.$route.query;this.id=t.id,this.showDetail()},mounted(){},filters:{fillTime(t){let e=t;return e=e.slice(0,11),e}},components:{},methods:{checkStrFormat(t){if(t==""||t==null||t==null)return!1;let e=!1;for(let a in t)d.checkStr(t[a],"numAndEnAndCnAndW")||(e=!0);return e},showDetail(){this.$api.getAppealDetail({id:this.id}).then(t=>{if(t.code===200){let{aplContentVOList:e}=t.data;e.length>1&&(this.zuijiaData=e.slice(1)),this.mainData=e[0],console.log(this.mainData),console.log(this.zuijiaData),this.statueData=t.data}else uni.showToast({icon:"none",title:t.msg})})},upZhujia(){if(this.zuijia.aplBatNum=this.statueData.aplContentVOList[this.statueData.aplContentVOList.length-1].aplBatNum+1,!this.zuijia.aplContent.trim()){this.$toast("\u8BF7\u8F93\u5165\u8BC9\u6C42\u5185\u5BB9");return}if(d.trimAllSpace(this.zuijia.aplContent)!=""&&this.checkStrFormat(d.trimAllSpace(this.zuijia.aplContent)))return this.$toast("\u4E0D\u80FD\u8F93\u5165\u7279\u6B8A\u5B57\u7B26"),!1;!this.hasUploadDone||(this.zuijia.aplId=this.statueData.id,this.zuijia.attachmentList=this.picImgs.map(t=>({id:t.attachId})),this.$api.appealZuijia(this.zuijia).then(t=>{t.code==200?this.$router.push({name:"appealList",query:{tabIndex:1}}):this.$toast(t.msg)}))},radioChange(t){console.log(t),this.current=t.detail.value},changeColl(t){this.collCurrent=this.collCurrent==t.index?-1:t.index},imgDelete(t,e){let a=this.imgListIds[e];this.imgListSo.splice(e,1),this.$api.removeAttachment({id:a},{"content-type":"application/json;charset=UTF-8"}).then(i=>{uni.hideLoading(),i.code==200&&(this.imgListIds.splice(e,1),this.imgListSo.splice(e,1))})},async chooseFile(t,e){if(console.log(e),!e||!d.isArray(e))return;let a=t,i=[],s=[],n=t.length;uni.showLoading({title:"\u4E0A\u4F20\u4E2D",mask:!0});for(let u of a){let l=await this.uploadPic(u);l.attachId&&!this.imgListIds.includes(l.attachId)&&(i.push(l.attachId),i.length===n&&uni.hideLoading()),l.link&&!this.imgListSo.includes(l.link)&&s.push({fOssAddr:l.link})}this.imgListIds=i,this.zuijia.attachmentList=s},uploadPic(t){return new Promise((e,a)=>{uploadFiles(t).then(i=>{i.code==200&&i.data?e(i.data):(uni.hideLoading(),uni.showToast({icon:"none",title:i.msg}),a())})})}}},f=t=>(x("data-v-f602c124"),t=t(),I(),t),S={class:"cont-new"},k={class:"inputList"},w={class:"inputCont flex-ro justify-side align-start",style:{border:"none"}},N=f(()=>o("div",{class:"input-title flex-ro"},[z(" \u8BC9\u6C42\u5185\u5BB9"),o("text",{class:"sp"},"*")],-1)),A={class:"input-text"},V={class:"inputCont flex-ro justify-side",style:{border:"none"}},U=f(()=>o("div",{class:"input-title flex-ro"}," \u8BC9\u6C42\u7167\u7247 ",-1)),b={class:"inputUpload",style:{padding:"0"}},P={class:"btn"};function E(t,e,a,i,s,n){const u=r("appealList-common"),l=r("van-collapse-item"),_=r("van-collapse"),v=r("upload-pics");return C(),L("div",S,[p(_,{modelValue:i.activeNames,"onUpdate:modelValue":e[0]||(e[0]=c=>i.activeNames=c)},{default:h(()=>[p(l,{title:"\u5DF2\u63D0\u4EA4\u8BC9\u6C42",name:"1"},{default:h(()=>[p(u,{statueData:s.statueData,zuijiaData:s.zuijiaData,mainData:s.mainData},null,8,["statueData","zuijiaData","mainData"])]),_:1})]),_:1},8,["modelValue"]),o("div",k,[o("div",w,[N,o("div",A,[j(o("textarea",{"onUpdate:modelValue":e[1]||(e[1]=c=>s.zuijia.aplContent=c),style:{height:"150px"},maxlength:"500","placeholder-style":"color:#D0D0D0;font-size:14px;",placeholder:"500\u5B57\u7B26\u4EE5\u5185\uFF0C\u652F\u6301\u5B57\u6BCD\uFF08\u5927\u5C0F\u5199\uFF09\u548C\u6570\u5B57"},null,512),[[g,s.zuijia.aplContent]])])]),o("div",V,[U,o("div",b,[p(v,{onReceivePic:i.receivePic,onUploadDone:i.uploadDone},null,8,["onReceivePic","onUploadDone"])])])]),o("div",P,[o("button",{class:"normal-btn",onClick:e[2]||(e[2]=(...c)=>n.upZhujia&&n.upZhujia(...c))},"\u63D0\u4EA4")])])}var rt=D(y,[["render",E],["__scopeId","data-v-f602c124"]]);export{rt as default};
